



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Tutorials for using Galaxy Australia">
      
      
        <link rel="canonical" href="https://galaxy-au-training.github.io/tutorials/modules/dge/">
      
      
        <meta name="author" content="Anna Syme, Gareth Price, Torsten Seemann">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.4, mkdocs-material-2.9.0">
    
    
      
        <title>RNA-seq - bacteria - Galaxy Australia Training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.4f4f49e8.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../css/sepsis.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#rna-seq-bacteria" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://galaxy-au-training.github.io/tutorials/" title="Galaxy Australia Training" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Galaxy Australia Training
              </span>
              <span class="md-header-nav__topic">
                RNA-seq - bacteria
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/Galaxy-Au-training/tutorials/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Galaxy-Australia-training/tutorials
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    Galaxy Australia Training
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/Galaxy-Au-training/tutorials/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Galaxy-Australia-training/tutorials
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../galaxy/" title="Get started" class="md-nav__link">
      Get started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../intro/" title="Learn key tasks" class="md-nav__link">
      Learn key tasks
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../fastqc/" title="Quality control" class="md-nav__link">
      Quality control
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../spades/" title="Genome assembly" class="md-nav__link">
      Genome assembly
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../prokka/" title="Genome annotation" class="md-nav__link">
      Genome annotation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../snippy/" title="Variant calling - bacteria" class="md-nav__link">
      Variant calling - bacteria
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../variants/" title="Variant calling - human" class="md-nav__link">
      Variant calling - human
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../abricate/" title="Antibiotic-resistant genes" class="md-nav__link">
      Antibiotic-resistant genes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../mlst/" title="Using MLST" class="md-nav__link">
      Using MLST
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../kraken/" title="Sample identification" class="md-nav__link">
      Sample identification
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        RNA-seq - bacteria
      </label>
    
    <a href="./" title="RNA-seq - bacteria" class="md-nav__link md-nav__link--active">
      RNA-seq - bacteria
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" title="Background" class="md-nav__link">
    Background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-data-reads-and-reference" title="Input data: reads and reference" class="md-nav__link">
    Input data: reads and reference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upload-files-to-galaxy" title="Upload files to Galaxy" class="md-nav__link">
    Upload files to Galaxy
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-shared-data" title="Use shared data" class="md-nav__link">
    Use shared data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#or-import-from-the-web" title="Or, import from the web" class="md-nav__link">
    Or, import from the web
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#align-reads-to-reference" title="Align reads to reference" class="md-nav__link">
    Align reads to reference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#count-reads-per-gene" title="Count reads per gene" class="md-nav__link">
    Count reads per gene
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dge-in-degust" title="DGE in Degust" class="md-nav__link">
    DGE in Degust
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#upload-counts-file" title="Upload counts file" class="md-nav__link">
    Upload counts file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overview-of-degust-sections" title="Overview of Degust sections" class="md-nav__link">
    Overview of Degust sections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyze-gene-expression" title="Analyze gene expression" class="md-nav__link">
    Analyze gene expression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mds-plot" title="MDS plot" class="md-nav__link">
    MDS plot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expression-ma-plot" title="Expression - MA plot" class="md-nav__link">
    Expression - MA plot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expression-parallel-coordinates-and-heatmap" title="Expression - Parallel Coordinates and heatmap" class="md-nav__link">
    Expression - Parallel Coordinates and heatmap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-of-genes" title="Table of genes" class="md-nav__link">
    Table of genes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dge-in-galaxy" title="DGE in Galaxy" class="md-nav__link">
    DGE in Galaxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#investigate-differentially-expressed-genes" title="Investigate differentially-expressed genes" class="md-nav__link">
    Investigate differentially-expressed genes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-this-history-in-galaxy" title="See this history in Galaxy" class="md-nav__link">
    See this history in Galaxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" title="What's next?" class="md-nav__link">
    What's next?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../rna-humans/" title="RNA-seq - eukaryotes" class="md-nav__link">
      RNA-seq - eukaryotes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../metagenomics/metagenomics/" title="Metagenomics" class="md-nav__link">
      Metagenomics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflows/" title="Galaxy workflows - introduction" class="md-nav__link">
      Galaxy workflows - introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflow-assembly/" title="Workflow - genome assembly" class="md-nav__link">
      Workflow - genome assembly
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflow-annotation/" title="Workflow - genome annotation" class="md-nav__link">
      Workflow - genome annotation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflow-variant-calling/" title="Workflow - variant calling, bacteria" class="md-nav__link">
      Workflow - variant calling, bacteria
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflow-rna-seq/" title="Workflow - RNA-seq" class="md-nav__link">
      Workflow - RNA-seq
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../shortreads/" title="Short read data" class="md-nav__link">
      Short read data
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../refseq/" title="Reference genomes" class="md-nav__link">
      Reference genomes
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" title="Background" class="md-nav__link">
    Background
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-data-reads-and-reference" title="Input data: reads and reference" class="md-nav__link">
    Input data: reads and reference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upload-files-to-galaxy" title="Upload files to Galaxy" class="md-nav__link">
    Upload files to Galaxy
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-shared-data" title="Use shared data" class="md-nav__link">
    Use shared data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#or-import-from-the-web" title="Or, import from the web" class="md-nav__link">
    Or, import from the web
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#align-reads-to-reference" title="Align reads to reference" class="md-nav__link">
    Align reads to reference
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#count-reads-per-gene" title="Count reads per gene" class="md-nav__link">
    Count reads per gene
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dge-in-degust" title="DGE in Degust" class="md-nav__link">
    DGE in Degust
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#upload-counts-file" title="Upload counts file" class="md-nav__link">
    Upload counts file
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#overview-of-degust-sections" title="Overview of Degust sections" class="md-nav__link">
    Overview of Degust sections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analyze-gene-expression" title="Analyze gene expression" class="md-nav__link">
    Analyze gene expression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mds-plot" title="MDS plot" class="md-nav__link">
    MDS plot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expression-ma-plot" title="Expression - MA plot" class="md-nav__link">
    Expression - MA plot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expression-parallel-coordinates-and-heatmap" title="Expression - Parallel Coordinates and heatmap" class="md-nav__link">
    Expression - Parallel Coordinates and heatmap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table-of-genes" title="Table of genes" class="md-nav__link">
    Table of genes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dge-in-galaxy" title="DGE in Galaxy" class="md-nav__link">
    DGE in Galaxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#investigate-differentially-expressed-genes" title="Investigate differentially-expressed genes" class="md-nav__link">
    Investigate differentially-expressed genes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-this-history-in-galaxy" title="See this history in Galaxy" class="md-nav__link">
    See this history in Galaxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whats-next" title="What's next?" class="md-nav__link">
    What's next?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Galaxy-Au-training/tutorials/edit/master/docs/modules/dge/index.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="rna-seq-bacteria">RNA-Seq: Bacteria</h1>
<p>This tutorial is about using RNA-seq data to investigate differential gene expression in bacteria, using Galaxy tools and Degust (a tool on the web).</p>
<p><fn><strong>New to Galaxy?</strong> First try the <a href="../galaxy/">introduction</a> and then learn some <a href="../intro/">key tasks</a></fn></p>
<!-- **FIXME:**
- (Fastq files have been shortened to 1% using seqtk)
- Data files (Fastq reads and refs): link to swift URL? -- add correct link to the "input data" section - RNA-Seq data - and information about how to upload
-->

<h2 id="background">Background</h2>
<p>Differential Gene Expression (DGE) is the process of determining whether any genes were expressed at a different level between two conditions. For example, the conditions could be wildtype versus mutant, or two growth conditions. Usually multiple biological replicates are done for each condition - these are needed to separate variation within the condition from that between the conditions.</p>
<!-- ## Learning Objectives

At the end of this tutorial you should be able to:

1. Align RNA-Seq data to a reference genome  
2. Count transcripts for each sample
3. Perform statistical analysis to obtain a list of differentially expressed genes
4. Visualize and interpret the results
-->

<h2 id="input-data-reads-and-reference">Input data: reads and reference</h2>
<p><strong>RNA-Seq reads</strong></p>
<p>A typical experiment will have 2 conditions each with 3 replicates, for a total of 6 samples.</p>
<ul>
<li>Our RNA-seq reads are from 6 samples in <fn>FASTQ</fn> format.<ul>
<li>We have single-end reads; so one file per sample.</li>
<li>Data could also be paired-end reads, and there would be two files per sample.</li>
</ul>
</li>
<li>These have been reduced to 1% of their original size for this tutorial.</li>
<li>The experiment used the bacteria <em>E. coli</em> grown in two conditions.<ul>
<li>Files labelled &ldquo;LB&rdquo; are the wildtype</li>
<li>Files labelled &ldquo;MG&rdquo; have been exposed to 0.5% &alpha;MG - alpha methyglucoside (a sugar solution).</li>
</ul>
</li>
</ul>
<!--
|             | Condition 1 | Condition 2 |
|-------------|-------------|-------------|
| Replicate 1 |     1       |      4      |
| Replicate 2 |     2       |      5      |
| Replicate 3 |     3       |      6      |

-->

<p><strong>Reference genome</strong></p>
<p>The reference genomes is in <fn>FASTA</fn> format and the gene annotations are in <fn>GTF</fn> format.</p>
<ul>
<li>The <fn>FASTA</fn> file contains the DNA sequence(s) that make up the genome; e.g. the chromosome and any plasmids.</li>
<li>The <fn>GTF</fn> file lists the coordinates (position) of each feature. Commonly-annotated features are genes, transcripts and protein-coding sequences.</li>
</ul>
<!--
- Where is it and how to upload. e.g. [RNA-Seq data](/rna/data.md)
- For the RNA-seq reads, change datatype to fastqsanger (not fastqCsanger)
- For the reference genome in GTF format, change datatype to GTF (not GFF)
-->

<h2 id="upload-files-to-galaxy">Upload files to Galaxy</h2>
<ul>
<li>Log in to your Galaxy instance (for example, Galaxy Australia, <a href="https://usegalaxy.org.au/">usegalaxy.org.au</a>).</li>
</ul>
<h3 id="use-shared-data">Use shared data</h3>
<p>If you are using Galaxy Australia, you can import the data from a shared data library.</p>
<p>In the top menu bar, go to <ss>Shared Data</ss>.</p>
<ul>
<li>Click on <ss>Data Libraries</ss>.</li>
<li>Click on <fn>Galaxy Australia Training Material: RNA-Seq: Microbial RNA-Seq</fn>.</li>
<li>Tick the boxes next to the eight files.</li>
<li>Click the <ss>To History</ss> button, select <em>As Datasets</em>.</li>
<li>Name a new history and click <ss>Import</ss>.</li>
<li>In the top menu bar, click <ss>Analyze Data</ss>.</li>
<li>You should now have eight files in your current history.</li>
</ul>
<h3 id="or-import-from-the-web">Or, import from the web</h3>
<p><em>Only follow this step if unable to load the data files from shared data, as described above</em>.</p>
<ul>
<li>In a new browser tab, go to this webpage:</li>
<li><a href="https://doi.org/10.5281/zenodo.1311269"><img alt="DOI" src="https://zenodo.org/badge/DOI/10.5281/zenodo.1311269.svg" /></a></li>
<li>For each file, right click on file name: select &ldquo;copy link address&rdquo;</li>
<li>In Galaxy, go to <ss>Get Data</ss> and then Upload File</li>
<li>Click <ss>Paste/Fetch data</ss></li>
<li>A box will appear: paste in link address</li>
<li>Click <ss>Start</ss></li>
<li>Click <ss>Close</ss></li>
<li>The file will now appear in the top of your history panel.</li>
<li>Repeat for all files in Zenodo.</li>
<li>Change (shorten) the file names with the pencil icon.</li>
</ul>
<p><img alt="Files for DGE" src="./images/image18.png" /></p>
<!--

    https://zenodo.org/record/1311269/files/E_coli_aMG1.fastq?download=1
    https://zenodo.org/record/1311269/files/E_coli_aMG2.fastq?download=1
    https://zenodo.org/record/1311269/files/E_coli_aMG3.fastq?download=1
    https://zenodo.org/record/1311269/files/E_coli_Lb1.fastq?download=1
    https://zenodo.org/record/1311269/files/E_coli_Lb2.fastq?download=1
    https://zenodo.org/record/1311269/files/E_coli_Lb3.fastq?download=1
    https://zenodo.org/record/1311269/files/Ecoli_k12.fasta?download=1
    https://zenodo.org/record/1311269/files/Ecoli_k12.gtf?download=1

-->

<!--

- Log in to your Galaxy server, e.g. Galaxy Australia (usegalaxy.org.au).
- In the <ss>History</ss> pane, click on the cog![cog icon](images/Galaxy-cog.png)icon, and select <ss>Import from File</ss> (at the bottom of the list).
- Under <ss>Archived History URL</ss> paste:
<tt>https://swift.rc.nectar.org.au:8888/v1/AUTH_377/public/Microbial_tutorials/Galaxy-History-BacterialDGE.tar.gz</tt>
- In the <ss>History</ss> pane, click on the view![view icon](images/Galaxy-histories.png)icon and find the uploaded history.
    - (This may take a minute. Refresh the page.)
- Click <ss>Switch to</ss> that history, then <ss>Done</ss>.
-->

<h2 id="align-reads-to-reference">Align reads to reference</h2>
<p>The RNA-Seq reads are fragmented and are not complete transcripts. To determine the transcripts from which the reads originated (and therefore, to which gene they correspond) we can map them to a reference genome.</p>
<p>In Galaxy:</p>
<ul>
<li>In the <ss>Tools</ss> panel, search for <ss>Map with BWA-MEM</ss> and click on it.</li>
<li>Under <ss>Will you select a reference genome from your history or use a built-in index?</ss>: <em>Use a genome from history and build index</em></li>
<li><ss>Use the following dataset as the reference sequence</ss>: <fn>Ecoli_k12.fasta</fn></li>
<li><ss>Single or Paired-end reads</ss>: <em>single</em></li>
<li><ss>Select fastq dataset</ss>:<ul>
<li>Click on the <ss>Multiple Datasets</ss> icon in centre</li>
<li>Select all 6 <fn>FASTQ</fn> files (they turn blue; use side-scroll bar to check all have been selected)</li>
<li>This will map each set of reads to the reference genome</li>
</ul>
</li>
</ul>
<p>Your tool interface should look like this:</p>
<p><img alt="BWA-MEM tool commands" src="./images/image02.png" /></p>
<ul>
<li>Click <ss>Execute</ss></li>
<li>Click <ss>Refresh</ss> in the history pane to see if the analysis has finished.</li>
<li>
<p>Output: 6 <fn>bam</fn> files of reads mapped to the reference genome.</p>
</li>
<li>
<p>Re-name the output files:</p>
<ul>
<li>These are called <fn>Map with BWA-MEM on data x and data x</fn>.</li>
<li>The x will refer to the numbered file that Galaxy used in the analysis.</li>
<li>Click on the pencil icon next to each of these and re-name them as their sample name (e.g. LB1, LB2 etc.).</li>
</ul>
</li>
</ul>
<h2 id="count-reads-per-gene">Count reads per gene</h2>
<p>We now need to count how many reads overlap with particular genes. The information about gene names is from the annotations in the GTF file.</p>
<p>In Galaxy:</p>
<ul>
<li>In the <ss>Tools</ss> panel, search for <ss>count matrix</ss> and click on <ss>SAM/BAM to count matrix</ss><ul>
<li>Note: Don&rsquo;t select the tool called <em>htseq-count</em>. The <em>SAM/BAM to count matrix</em> also uses that tool but allows an input of multiple bam files, which is what we want.</li>
</ul>
</li>
<li>For <ss>Gene model (GFF) file to count reads over from your current history</ss>, select the <fn>GTF</fn> file.</li>
<li>For <ss>Reads are stranded</ss> select <em>Yes</em> (box turns dark grey)</li>
<li>For <ss>GTF feature type for counting reads&hellip;</ss> select <em>transcript</em>.</li>
<li>For <ss>bam/sam file from your history</ss> choose the 6 <fn>bam</fn> files.</li>
</ul>
<p>Your tool interface should look like this:</p>
<p><img alt="HTSeq tool commands" src="./images/image08.png" /></p>
<ul>
<li>Click <ss>Execute</ss></li>
<li>Click <ss>Refresh</ss> in the history pane to see if the analysis has finished.</li>
</ul>
<p>Output:</p>
<ul>
<li>There is one output file: <fn>bams to DGE count matrix</fn>.</li>
<li>Click on the file name to expand the information in the History pane.</li>
<li>Click on the file <img alt="File icon" src="./images/Galaxy-download.png" />icon underneath to download it to your computer for use later on in this tutorial.</li>
<li>Click on the eye icon to see this file.</li>
</ul>
<p><img alt="counts file" src="./images/image09.png" /></p>
<ul>
<li>Each row is a gene (or feature) and each column is a sample, with counts against each gene.</li>
<li>Have a look at how the counts vary between samples, per gene.</li>
<li>We can&rsquo;t just compare the counts directly; they need to be normalized before comparison, and this will be done as part of the DGE analysis in the next step.</li>
</ul>
<h2 id="dge-in-degust">DGE in Degust</h2>
<p>Degust is a tool on the web that can analyse the counts files produced in the step above, to test for differential gene expression.</p>
<p>(Degust can also display the results from DGE analyses performed elsewhere.)</p>
<h3 id="upload-counts-file">Upload counts file</h3>
<p>Go to the <a href="http://degust.erc.monash.edu/">Degust web page</a>.</p>
<ul>
<li>Click <ss>Upload your counts file</ss>.</li>
<li>Click on <ss>Choose File</ss>.</li>
<li>Select the <fn>htseq output file. tabular</fn> (that you previously downloaded to your computer from Galaxy) and click <ss>Open</ss>. This file may have a different name, for example, it may have &ldquo;Galaxy&rdquo; in the title.</li>
<li>Click <ss>Upload</ss>.</li>
</ul>
<p>A Configuation page will appear.</p>
<ul>
<li>For <ss>Name</ss> type <em>DGE in E coli</em></li>
<li>For <ss>Info columns</ss> select <em>Contig</em></li>
<li>For <ss>Analyze server side</ss> leave box checked.</li>
<li>For <ss>Min gene read count</ss> put <em>10</em>.</li>
<li>Click <ss>Add condition</ss><ul>
<li>Add a condition called &ldquo;Control&rdquo; and select the LB columns.</li>
<li>Add a condition called &ldquo;Treament&rdquo; and select the MG columns.</li>
</ul>
</li>
<li><ss>Save changes</ss></li>
<li><ss>View</ss> - this brings up the Degust viewing window.</li>
</ul>
<h3 id="overview-of-degust-sections">Overview of Degust sections</h3>
<ul>
<li>Top black panel with <ss>Configure</ss> settings at right.</li>
<li>Left: Conditions: Control and Treatment.</li>
<li>Left: Method selection for DGE.</li>
<li>Top centre: Plots, with options at right.</li>
<li>When either of the expression plots are selected, a heatmap appears below.</li>
<li>A table of genes (or features); expression in treatment relative to control (Treatment column); and significance (FDR column).  </li>
</ul>
<p><img alt="Degust overview" src="./images/image12.png" /></p>
<h3 id="analyze-gene-expression">Analyze gene expression</h3>
<ul>
<li>Under <ss>Method</ss>, make sure that <ss>Voom/Limma</ss> is selected.</li>
<li>Click <ss>Apply</ss>. This runs Voom/Limma on the uploaded counts.</li>
</ul>
<h3 id="mds-plot">MDS plot</h3>
<p>First, look at the MDS plot.</p>
<p><img alt="MDSplot" src="./images/image11.png" /></p>
<ul>
<li>This is a multidimensional scaling plot which represents the variation between samples.</li>
<li>Ideally:<ul>
<li>All the LB samples would be close to each other</li>
<li>All the MG samples would be close to each other</li>
<li>The LB and MG groups would be far apart</li>
</ul>
</li>
<li>The x-axis is the dimension with the highest magnitude. The control/treatment samples should be split along this axis.</li>
<li>Our LB samples are on the left and the MG samples are on the right, which means they are well separated on their major MDS dimension, which looks correct.</li>
</ul>
<h3 id="expression-ma-plot">Expression - MA plot</h3>
<p>Each dot shows the change in expression in one gene.</p>
<ul>
<li>The average expression (over both condition and treatment samples) is represented on the x-axis.<ul>
<li>Plot points should be symmetrical around the x-axis.</li>
<li>We can see that many genes are expressed at a low level, and some are highly expressed.</li>
</ul>
</li>
<li>The fold change is represented on the y axis.<ul>
<li>If expression is significantly different between treatment and control, the dots are red. If not, they are blue. (In Degust, significant means FDR &lt;0.05).</li>
<li>At low levels of gene expression (low values of the x axis), fold changes are less likely to be significant.</li>
</ul>
</li>
</ul>
<p>Click on the dot to see the gene name.     </p>
<p><img alt="MAplot" src="./images/image17.png" /></p>
<h3 id="expression-parallel-coordinates-and-heatmap">Expression - Parallel Coordinates and heatmap</h3>
<p>Each line shows the change in expression in one gene, between control and treatment.</p>
<ul>
<li>Go to <ss>Options</ss> at the right.<ul>
<li>For <ss>FDR cut-off</ss> set at 0.001.</li>
<li>This is a significance level (an adjusted p value). We will set it quite low in this example, to ensure we only examine key differences.</li>
</ul>
</li>
<li>
<p>Look at the Parallel Coordinates plot. There are two axes:</p>
<ul>
<li>Left: <strong>Control</strong>: Gene expression in the control samples. All values are set at zero.</li>
<li>Right: <strong>Treatment</strong> Gene expression in the treatment samples, relative to expression in the control.</li>
</ul>
</li>
<li>
<p>The blocks of blue and red underneath the plot are called a heatmap.</p>
<ul>
<li>Each block is a gene. Click on a block to see its line in the plot above.</li>
<li>Look at the row for the Treatment. Relative to the control, genes expressed more are red; genes expressed less are blue.</li>
</ul>
</li>
</ul>
<p><img alt="Parallel Coordinates plot" src="./images/image14.png" /></p>
<p>Note:</p>
<ul>
<li>for an experiment with multiple treatments, the various treatment axes can be dragged to rearrange. There is no natural order (such as a time series).</li>
</ul>
<h3 id="table-of-genes">Table of genes</h3>
<ul>
<li><strong>Contig</strong>: names of genes. Note that gene names are sometimes specific to a species, or they may be only named as a locus ID (a chromosomal location specified in the genome annotation).</li>
<li><strong>FDR</strong>: False Discovery Rate. This is an adjusted p value to show the significance of the difference in gene expression between two conditions. Click on column headings to sort. By default, this table is sorted by FDR.</li>
<li><strong>Control</strong> and <strong>Treatment</strong>: log2(Fold Change) of gene expression. The default display is of fold change in the treatment relative to the control. Therefore, values in the &ldquo;Control&rdquo; column are zero. This can be changed in the <ss>Options</ss> panel at the top right.</li>
<li>In some cases, a large fold change will be meaningful but in others, even a small fold change can be important biologically.</li>
</ul>
<p>Table of genes and expression:</p>
<p><img alt="gene table" src="./images/image15.png" /></p>
<!--
A pathway is a drawn network to show interaction between molecules, including some or all of genes, proteins, RNAs, chemical reactions. E.g.
The Kegg pathway database: (Kyoto Encyclopedia of Genes and Genomes)
numbers are EC numbers - enzyme commission ->  enzyme/s that catalyze a reaction (might be >1)
-->

<h2 id="dge-in-galaxy">DGE in Galaxy</h2>
<p>Differential gene expression can also be analyzed in Galaxy. The input is the count matrix produced by a tool such as HTSeq-Count (see section above: &ldquo;Count reads per gene&rdquo;).</p>
<ul>
<li>In the <ss>Tools</ss> panel, search for <ss>Differential_Count models</ss> (don&rsquo;t forget the underscore) and click on it.<ul>
<li>This has options to use edgeR, DESeq, or Voom. Here we will use Voom.</li>
</ul>
</li>
<li>For <ss>Select an input matrix</ss> choose the <fn>count matrix</fn> file generated in the previous step.</li>
<li>For <ss>Title for job outputs</ss> enter <em>DGE using voom</em>.</li>
<li>For <ss>Select columns containing treatment</ss> tick boxes for the MG samples.</li>
<li>For <ss>Select columns containing control</ss> tick boxes for the LB samples.</li>
<li>Under <ss>Run this model using edgeR</ss> choose <em>Do not run edgeR</em>.</li>
<li>Under <ss>Run the same model with DESeq2 and compare findings</ss> choose <em>Do not run DESeq2</em>.</li>
<li>Under <ss>Run the same model with Voom/limma and compare findings</ss> choose <em>Run VOOM</em>.</li>
</ul>
<p>Your tool interface should look like this:</p>
<p><img alt="DGE using voom" src="./images/image16.png" /></p>
<ul>
<li>Click <ss>Execute</ss>.</li>
</ul>
<p>There are two output files.</p>
<p>View the file called <fn>DGEusingvoom.html</fn>.</p>
<ul>
<li>Scroll down to &ldquo;VOOM log output&rdquo; and &ldquo;#VOOM top 50&rdquo;.</li>
<li>The &ldquo;Contig&rdquo; column has the gene names.</li>
<li>Look at the &ldquo;adj.P.Val&rdquo; column. This is an adjusted p value to show the significance of the gene expression difference, accounting for the effect of multiple testing. Also known as False Discovery Rate. The table is ordered by the values in this column.</li>
<li>Look at the &ldquo;logFC&rdquo; column. This is log2(Fold Change) of relative gene expression between the treatment samples and the control samples.</li>
</ul>
<p>View the file called <fn>DEGusingvoom_topTable_VOOM.xls</fn>.</p>
<ul>
<li>
<p>This is a list of all the genes that had transcripts mapped, and associated statistics.</p>
</li>
<li>
<p><a href="https://genomebiology.biomedcentral.com/articles/10.1186/gb-2014-15-2-r29">Link to Voom paper.</a></p>
</li>
</ul>
<h2 id="investigate-differentially-expressed-genes">Investigate differentially-expressed genes</h2>
<p>To learn more about the differentially-expressed genes:</p>
<ul>
<li>Go to <a href="http://www.ncbi.nlm.nih.gov">the NCBI website.</a></li>
<li>Under <ss>All Databases</ss>, click on <em>Gene</em></li>
<li>Enter the gene name in the search bar; e.g. ptsG</li>
<li>Click on the first result that matches the species (e.g. in this case, <em>E. coli</em>).<ul>
<li>This provides information about the gene, and may also show further references (e.g. in this case, a link to the EcoGene resource).</li>
</ul>
</li>
</ul>
<p>Some of the most (statistically) significant differentially-expressed genes in this experiment are:</p>
<ul>
<li><a href="http://www.ncbi.nlm.nih.gov/gene/945651">ptsG</a>: a glucose-specific transporter.</li>
<li><a href="http://www.ncbi.nlm.nih.gov/gene/944793">setA</a>: a sugar efflux transporter; is induced by glucose-phosphate stress.</li>
<li><a href="http://www.ncbi.nlm.nih.gov/gene/945314">sucD</a>: the alpha subunit of the the gene for succinyl-CoA synthetase; involved in ATP production.</li>
<li><a href="http://www.ncbi.nlm.nih.gov/gene/945307">sucB</a>: a component of the 2-oxoglutarate dehydrogenase complex; catalyzes a step in the Krebs cycle.</li>
<li><a href="http://www.ncbi.nlm.nih.gov/gene/948902">deoC</a>: 2-deoxyribose-5-phosphate aldolase; binds selenium; may be involved in selenium transport.</li>
</ul>
<!-- Next steps: Investigate the biochemical pathways involving the genes of interest.-->

<h2 id="see-this-history-in-galaxy">See this history in Galaxy</h2>
<p>If you want to see this Galaxy history without performing the steps above:</p>
<ul>
<li>Log in to Galaxy Australia: <a href="https://usegalaxy.org.au/">https://usegalaxy.org.au/</a></li>
<li>Go to <ss>Shared Data</ss></li>
<li>Click <ss>Histories</ss></li>
<li>Click <fn>Completed-RNA-seq-bacteria</fn></li>
<li>Click <ss>Import</ss> (at the top right corner)</li>
<li>The analysis should now be showing as your current history.</li>
</ul>
<h2 id="whats-next">What&rsquo;s next?</h2>
<p>To use the tutorials on this website:</p>
<ul>
<li>&#8592; see the list in the left hand panel</li>
<li>&#8598; or, click the <strong>menu button</strong> (three horizontal bars) in the top left of the page</li>
</ul>
<p>You can find more tutorials at the Galaxy Training Network:</p>
<ul>
<li><a href="http://galaxyproject.github.io/training-material/">http://galaxyproject.github.io/training-material/</a></li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../kraken/" title="Sample identification" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Sample identification
              </span>
            </div>
          </a>
        
        
          <a href="../rna-humans/" title="RNA-seq - eukaryotes" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                RNA-seq - eukaryotes
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; The authors; 2018-
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="" class="md-footer-social__link fa fa-coffee"></a>
    
      <a href="https://github.com/Galaxy-Au-training/tutorials" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://github.com/Galaxy-Au-training/tutorials/issues" class="md-footer-social__link fa fa-bug"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.a59e2a89.js"></script>
      
      <script>app.initialize({version:"0.17.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>