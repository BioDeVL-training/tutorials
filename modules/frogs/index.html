



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Tutorials for using Galaxy Australia">
      
      
        <link rel="canonical" href="https://galaxy-au-training.github.io/tutorials/modules/frogs/">
      
      
        <meta name="author" content="Anna Syme, Gareth Price, Torsten Seemann">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.6">
    
    
      
        <title>Galaxy Australia Training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../css/sepsis.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#metagenomics" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://galaxy-au-training.github.io/tutorials/" title="Galaxy Australia Training" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Galaxy Australia Training
              </span>
              <span class="md-header-nav__topic">
                Home
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/Galaxy-Au-training/tutorials/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Galaxy-Australia-training/tutorials
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://galaxy-au-training.github.io/tutorials/" title="Galaxy Australia Training" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Galaxy Australia Training
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/Galaxy-Au-training/tutorials/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Galaxy-Australia-training/tutorials
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../galaxy/" title="Get started" class="md-nav__link">
      Get started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../intro/" title="Learn key tasks" class="md-nav__link">
      Learn key tasks
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../galaxy-data/" title="Download and Delete Data in Galaxy" class="md-nav__link">
      Download and Delete Data in Galaxy
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../fastqc/" title="Quality control" class="md-nav__link">
      Quality control
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../spades/" title="Genome assembly" class="md-nav__link">
      Genome assembly
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../prokka/" title="Genome annotation" class="md-nav__link">
      Genome annotation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../snippy/" title="Variant calling - bacteria" class="md-nav__link">
      Variant calling - bacteria
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../variants/" title="Variant calling - human" class="md-nav__link">
      Variant calling - human
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../abricate/" title="Antibiotic-resistant genes" class="md-nav__link">
      Antibiotic-resistant genes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../mlst/" title="Using MLST" class="md-nav__link">
      Using MLST
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../kraken/" title="Sample identification" class="md-nav__link">
      Sample identification
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../dge/" title="RNA-seq - bacteria" class="md-nav__link">
      RNA-seq - bacteria
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../rna-humans/" title="RNA-seq - eukaryotes" class="md-nav__link">
      RNA-seq - eukaryotes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../metagenomics/" title="Metagenomics" class="md-nav__link">
      Metagenomics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflows/" title="Galaxy workflows - introduction" class="md-nav__link">
      Galaxy workflows - introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflow-assembly/" title="Workflow - genome assembly" class="md-nav__link">
      Workflow - genome assembly
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflow-annotation/" title="Workflow - genome annotation" class="md-nav__link">
      Workflow - genome annotation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflow-variant-calling/" title="Workflow - variant calling, bacteria" class="md-nav__link">
      Workflow - variant calling, bacteria
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflow-rna-seq/" title="Workflow - Bacterial RNA-seq" class="md-nav__link">
      Workflow - Bacterial RNA-seq
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workflow-metagenomics/" title="Workflow - Metagenomics" class="md-nav__link">
      Workflow - Metagenomics
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../shortreads/" title="Short read data" class="md-nav__link">
      Short read data
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../refseq/" title="Reference genomes" class="md-nav__link">
      Reference genomes
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#get-data" title="Get data" class="md-nav__link">
    Get data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-pre-process" title="1. Pre-process" class="md-nav__link">
    1. Pre-process
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run" title="Run" class="md-nav__link">
    Run
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" title="Output" class="md-nav__link">
    Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-clustering-swarm" title="2. Clustering swarm" class="md-nav__link">
    2. Clustering swarm
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_1" title="Output" class="md-nav__link">
    Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-remove-chimera" title="3. Remove chimera" class="md-nav__link">
    3. Remove chimera
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_2" title="Output" class="md-nav__link">
    Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-filters" title="4. Filters" class="md-nav__link">
    4. Filters
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_3" title="Output" class="md-nav__link">
    Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-affiliation-otu" title="5. Affiliation OTU" class="md-nav__link">
    5. Affiliation OTU
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_4" title="Output" class="md-nav__link">
    Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-affiliations-stat" title="6. Affiliations stat" class="md-nav__link">
    6. Affiliations stat
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_5" title="Output" class="md-nav__link">
    Output
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" title="Links" class="md-nav__link">
    Links
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Galaxy-Au-training/tutorials/edit/master/docs/modules/frogs/index.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><br></p>
<h1 id="metagenomics">Metagenomics</h1>
<p>Metagenomics aims to compare microbial communities from different environments by using information from the metagenome. Typically, 16S rRNA is used when classifying taxa, and whole-genome sequencing when aiming to identify gene functions and pathways.</p>
<!-- - compare microbial communities from different environments: do this by comparing the metagenome: e.g. GC-content, k-mers, size, how many spp, functions of genes
- eg for function, can compare to a database (COG or KEGG) and see whether metagenomes differ (statistically test) -
- More about 16S rRNA: The 16S sequence is RNA that makes up part of the bacterial ribosome (together with other rRNA and protein). The operon is 16S, 23S, 5S - and there may be many copies of the operon (7 in E coli).
-->

<p>This tutorial covers the tool called FROGS (in Galaxy): &ldquo;Find Rapidly OTU with Galaxy Solution&rdquo;.
<!-- dental and phln only? --></p>
<!-- - uses a different way of clustering similar sequences into OTUs. -->

<h2 id="get-data">Get data</h2>
<ul>
<li>
<p>The data: paired-end Illumina reads from two environmental samples. <!-- two env samples? dental microbiomes?--></p>
</li>
<li>
<p>In Galaxy, in the history panel, click on the cog item, and select &ldquo;import from file&rdquo;.</p>
<ul>
<li>In the &ldquo;Archived History URL:&rdquo; box paste:</li>
<li>
<p><tt>https://swift.rc.nectar.org.au:8888/v1/AUTH_377/public/Microbial_tutorials/Galaxy-History-16S_metagenomics_dataset.tar.gz</tt></p>
</li>
<li>
<p>You should now have four files in your Galaxy history.</p>
</li>
</ul>
</li>
</ul>
<!-- - Download the <fn>.tar.gz</fn> file to your local computer using this link: <https://drive.google.com/open?id=0B-DKulJTTftlT2djQmJ4aTN6Q1U>.
- Click on the file to unzip it into four <fn>.gz</fn> files. These can stay zipped.
- In Galaxy, go to <ss>Get Data: Upload File</ss>. Choose the the four files, set their file type to "fastqsanger", click start, then close.
- The four files should now be in your current history.
-->

<!-- I have renamed these files as microbiomeA_R1 and microbiomeB_R1 etc -->

<ul>
<li>In the Galaxy tools panel, in the top search bar, type FROGS.<ul>
<li>This will bring up the various tools available.</li>
<li>We will be using 6 of these tools.</li>
</ul>
</li>
</ul>
<p><img alt="frogs_tools" src="images/frogs_tools.png" /></p>
<h2 id="1-pre-process">1. Pre-process</h2>
<p>This is the first step in the Frogs analysis. It takes in the forward and reverse sequencing reads (R1 and R2) from multiple samples (e.g. microbiome A and microbiome B) and performs the following steps:</p>
<ul>
<li>If the data is not in contigs, read1 and read2 will be overlapped (allowing some mismatch in overlapping region).</li>
<li>Contigs that are too big or too small will be filtered out. <!-- what's wrong with too big?--></li>
<li>If using the Illumina standard protocol: will look for those primers, filter out contigs without primers, and cut the primer sequences.</li>
<li>Sequences that are too small or of poor quality will be filtered out.</li>
<li>Sequences will be de-replicated: duplicates will be removed but the number of duplicates will be recorded.</li>
</ul>
<h3 id="run">Run</h3>
<p>Go to <ss>FROGS Pre-process</ss> and select the following:</p>
<ul>
<li><ss>Sequencer</ss>: Illumina</li>
<li><ss>Input type</ss>: Files by samples</li>
<li><ss>Reads alread contiged?</ss>: No</li>
<li><ss>Samples</ss>:<ul>
<li><ss>Name</ss>: microbiomeA &lt;<em>note: no spaces</em>&gt;</li>
<li><ss>Reads1</ss>: <fn>microbiomeA_R1.fq</fn></li>
<li><ss>Reads2</ss>: <fn>microbiomeA_R2.fq</fn></li>
<li><ss>Insert Samples</ss>- click plus sign</li>
<li><ss>Name</ss>: microbiomeB</li>
<li><ss>Reads1</ss>: <fn>microbiomeB_R1.fq</fn></li>
<li><ss>Reads2</ss>: <fn>microbiomeB_R2.fq</fn></li>
</ul>
</li>
<li><ss>Reads 1 size</ss>: 250</li>
<li><ss>Reads 2 size</ss>: 250</li>
<li><ss>Expected amplicon size</ss>: 420</li>
<li><ss>Minimum amplicon size</ss>: 380</li>
<li><ss>Maximum amplicon size</ss>: 460</li>
<li><ss>Sequencing protocol</ss>: Illumina standard</li>
<li><ss>5&rsquo; primer</ss>: GGCGVACGGGTGAGTAA</li>
<li><ss>3&rsquo; primer</ss>: GTGCCAGCNGCNGCGG &lt;<em>note: needs to be in 5&rsquo; to 3&rsquo; orientation</em>&gt;</li>
<li><ss>Execute</ss></li>
</ul>
<p><img alt="pre-process" src="images/pre-process.png" /></p>
<h3 id="output">Output</h3>
<p>There are three output files. Click on the eye icon for each to see their contents.</p>
<p>Report:</p>
<ul>
<li>The <fn>report.html</fn> shows how samples were filtered. For example, in the bar chart called &ldquo;Filtering summary&rdquo;, the number of reads kept at each filtering stage is displayed. We would expect some decrease in some of these categories, but if many reads have been filtered at a particular stage it could indicate poor quality data.</li>
</ul>
<p><img alt="filtering_summary1" src="images/filtering_summary1.png" /></p>
<ul>
<li>Below this chart, a table shows the statistics for each sample. Check the boxes next to &ldquo;microbiomeA&rdquo; and &ldquo;microbiomeB&rdquo; and then click <ss>Display amplicon lengths</ss> - shows amplicon distribution before filtering. Click <ss>Display preprocessed amplicon lengths</ss> - shows the distribution has been narrowed after filtering. Check if both samples are similar.</li>
</ul>
<p>Counts:</p>
<ul>
<li>The <fn>counts.tsv</fn> file is a list of sequences and their counts in the two samples.</li>
</ul>
<p>Fasta file:</p>
<ul>
<li>The <fn>dereplicated.fasta</fn> contains the sequences, without any duplicates.</li>
</ul>
<h2 id="2-clustering-swarm">2. Clustering swarm</h2>
<p>In this step, sequences are clustered into groups using Swarm (more information about <a href="https://peerj.com/articles/593/">Swarm</a>). This takes the pre-processed <fn>fasta</fn> and <fn>counts</fn> files and does the following:</p>
<ul>
<li>Sorts reads by abundance.</li>
<li>Clusters the reads into pre-clusters using Swarm and distance parameter of 1.</li>
<li>Sorts these pre-clusters by abundance.</li>
<li>Cluster the pre-clusters using Swarm and a user-specified distance.</li>
</ul>
<p>Go to <ss>FROGS Clustering swarm</ss> and select the following:</p>
<ul>
<li><ss>Sequences files</ss>: <fn>dereplicated.fasta</fn></li>
<li><ss>Counts file</ss>: <fn>count.tsv</fn></li>
<li><ss>Aggregation distance</ss>: 3</li>
<li><ss>Perform deionising clustering step?</ss>: Yes</li>
<li><ss>Execute</ss></li>
</ul>
<p><em>Note: Galaxy may say that the job submission has failed. Click Close, then click refresh in the top of the history panel. The job should be running.</em></p>
<p><img alt="clustering" src="images/clustering.png" /></p>
<h3 id="output_1">Output</h3>
<p>There are three output files.</p>
<ul>
<li>The <fn>abundance.biom</fn> shows the abundance of each cluster.</li>
<li>The <fn>seed_sequences.fasta</fn> contains the the cluster (OTU) representative sequences. <!-- the seqs used to start clustering? not the final clusterss? --></li>
<li>The <fn>swarms.composition.tsv</fn> shows what is in each cluster.</li>
</ul>
<h2 id="3-remove-chimera">3. Remove chimera</h2>
<p>Closely-related sequences may form chimeras (mixed sequences) during PCR (libray prep). This step removes these sequences by the following method:</p>
<ul>
<li>Splits input data into samples</li>
<li>Uses vsearch to find chimeras in each sample</li>
<li>Removes chimeras</li>
</ul>
<p>Go to <ss>FROGS Remove chimera</ss> and select the following:</p>
<ul>
<li><ss>Sequences file</ss>: <fn>seed_sequences.fasta</fn></li>
<li><ss>Abundance type</ss>: <fn>BIOM file</fn></li>
<li><ss>Abundance file</ss>: <fn>abundance.biom</fn></li>
<li><ss>Execute</ss></li>
</ul>
<p><em>Note: Galaxy may say that the job submission has failed. Click Close, then click refresh in the top of the history panel. The job should be running.</em></p>
<p><img alt="chimera" src="images/chimera.png" /></p>
<h3 id="output_2">Output</h3>
<p>There are three output files.</p>
<ul>
<li>The <fn>non_chimera.fasta</fn> is a filtered file containing no chimeras.</li>
<li>The <fn>non_chimera_abundance.biom</fn> is a filtered abundance file containing no chimeras.</li>
<li>The summary <fn>report.html</fn>. In this case, although almost 70% of the clusters were removed, more than 70% of the actual reads were kept.</li>
</ul>
<p><img alt="remove-summary" src="images/remove_summary.png" /></p>
<h2 id="4-filters">4. Filters</h2>
<p>The OTUs (Operational Taxonomic Units) have now been clustered. In this step, we will filter out some of the OTUs that are either not in both samples, and/or contain at least 0.005% of all the sequences.</p>
<p>Go to <ss>FROGS Filters</ss> and select the following:</p>
<ul>
<li><ss>Sequences file</ss>: <fn>non_chimera.fasta</fn></li>
<li><ss>Abundance file</ss>:  <fn>non_chimera_abundance.biom</fn></li>
<li><ss>*** THE FILTERS ON OTUS IN SAMPLES, OTUS SIZE and SEQUENCE PERCENTAGE</ss>: Apply filters</li>
<li><ss>Minimum number of samples</ss>: 2</li>
<li><ss>Minimum proportion/number of sequences to keep OTU</ss>: 0.00005</li>
<li><ss>N biggest OTU</ss>: leave blank</li>
<li><ss>*** THE FILTERS ON RDP</ss>: No filters</li>
<li><ss>*** THE FILTERS ON BLAST</ss>: No filters</li>
<li><ss>*** THE FILTERS ON CONTAMINATIONS</ss>: No filters</li>
<li><ss>Execute</ss></li>
</ul>
<p><img alt="filters" src="images/filters.png" />]</p>
<p><em>Note: Galaxy may say that the job submission has failed. Click Close, then click refresh in the top of the history panel. The job should be running.</em></p>
<h3 id="output_3">Output</h3>
<p>There are four output files.</p>
<ul>
<li><fn>sequences.fasta</fn>: the retained sequences.</li>
<li><fn>abudance.biom</fn>: the abundance file.</li>
<li><fn>excluded.tsv</fn>: discarded OTUs</li>
<li><fn>report.html</fn>: this shows the proportion of OTUs and the proportion of sequences kept. In this example, although most OTUs have been filtered out, most sequences have been retained.</li>
</ul>
<p><img alt="filters_summary" src="images/filters_summary.png" />
<!-- We should do 3+ samples
Then could click on Venn diagram here and see intersection.
--></p>
<h2 id="5-affiliation-otu">5. Affiliation OTU</h2>
<p>An OTU is a cluster of sequences. This step adds the taxonomy to the abundance file. It uses the SILVA database for rRNA.<!--add more info about Silva--></p>
<!-- - that has been filtered for only (16S or all 30S?), non-redundant, keeping certain taxonomic levels, and split into pro and eukaryotes.

blastn+ to align each OTU against seqs in the dbase, keeping the best.
- It can return multi-affiliation - see notes below tool panel.

-->

<p>Go to <ss>FROGS Affiliation OTU</ss> and select:</p>
<ul>
<li><ss>Using reference database</ss>: silva123</li>
<li><ss>Also perform RDP assignation</ss>: No</li>
<li><ss>OTU seed sequence</ss>: <fn>sequences.fasta</fn> from step 4</li>
<li><ss>Abundance file</ss>: <fn>abundance.biom</fn> from step 4</li>
<li><ss>Execute</ss></li>
</ul>
<p><img alt="otu" src="images/otu.png" /></p>
<p><em>Note: Galaxy may say that the job submission has failed. Click Close, then click refresh in the top of the history panel. The job should be running.</em></p>
<!-- can take 10 mins or so? -->

<h3 id="output_4">Output</h3>
<p>There are two output files.</p>
<ul>
<li>
<p><fn>affiliation.biom</fn>: the abundance file with affiliation. Note: this <fn>.biom</fn> file is not human-readable. If you wish, you can convert it with the FROGS <strong>biom to tsv</strong> tool.</p>
</li>
<li>
<p><fn>report.html</fn>: the report shows the proportion of OTUs and sequences affiliated to sequences in the database. Here we can see that almost all OTUs and sequences have been taxonomically assigned, but almost 10% of OTUs could be assigned to multiple species. <!--is that interpreation correct?--></p>
</li>
</ul>
<p><img alt="blast_summary" src="images/blast_affiliation.png" /></p>
<h2 id="6-affiliations-stat">6. Affiliations stat</h2>
<p>This step computes some statistics from the analysis and generates a report of the OTUs/taxonomy found.</p>
<p>Go to <ss>FROGS Affiliations stat</ss> and select:</p>
<ul>
<li><ss>Abundance file</ss>: <fn>affiliation.biom</fn> from step 5</li>
<li><ss>Rarefaction ranks</ss>: Class Order Family Genus Species</li>
<li><ss>Affiliation processed</ss>: FROGS blast</li>
<li><ss>Execute</ss></li>
</ul>
<p><img alt="otu-stat" src="images/otu-stat.png" /></p>
<h3 id="output_5">Output</h3>
<p>There is one output file. Click on the eye icon next to <fn>summary.html</fn>:</p>
<ul>
<li>click on <ss>Display global distribution</ss>: this shows the taxonomy of the sample. Start at the centre; major groups each have a segment by colour; as you go outwards, taxonomic identification becomes more specific. <!-- this is the pooled info from both samples? --> Click on a segment to display a table of statisics below. Click on the cross in the top right corner to exit.</li>
</ul>
<p><img alt="taxa-distribution" src="images/taxa_distribution.png" /></p>
<!--is there a way to summarize this info across samples? eg sample 1 had lots of taxon A compared to sample 2 etc... or this taxon found only in sample B etc... (although I think these ones were filtered out)? -->

<ul>
<li>Next, we will look at the rarefaction curve, which is a measure of samples vs diversity. <!-- is that correct? In other words, how many samples do we have to take before we are covering the taxonomic diversity?--> Click on the boxes next to each of the samples (both, or one at a time) in the table (microbiomeA and microbiomeB). Click <ss>Display rarefaction</ss>.</li>
</ul>
<p><img alt="rarefaction" src="images/rarefaction.png" /></p>
<h2 id="links">Links</h2>
<ul>
<li>FROGS slides by Yvan Le Bras <a href="https://f1000research.com/slides/5-1832">https://f1000research.com/slides/5-1832</a></li>
<li>The SILVA database: <a href="https://www.arb-silva.de/">https://www.arb-silva.de/</a></li>
<li>Other metagenomics software:<ul>
<li>QIIME: <a href="http://qiime.org/">http://qiime.org/</a>    </li>
<li>UPARSE: <a href="http://www.drive5.com/uparse/">http://www.drive5.com/uparse/</a></li>
<li>MOTHUR: <a href="https://www.mothur.org/">https://www.mothur.org/</a></li>
<li>MG-RAST: <a href="http://metagenomics.anl.gov/">http://metagenomics.anl.gov/</a></li>
</ul>
</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; The authors; 2018-
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="" class="md-footer-social__link fa fa-coffee"></a>
    
      <a href="https://github.com/Galaxy-Au-training/tutorials" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://github.com/Galaxy-Au-training/tutorials/issues" class="md-footer-social__link fa fa-bug"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.5e60981f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>